# **Документация проекта: Студия Подкастов с ИИ**

## 1. Обзор проекта

**Студия Подкастов с ИИ** — это передовое веб-приложение, предназначенное для автоматического создания коротких, атмосферных аудио-подкастов и видеоматериалов на заданную пользователем тему. Приложение генерирует полный пакет материалов: от уникального, SEO-оптимизированного сценария и профессиональной озвучки несколькими голосами до набора визуальных материалов, включая фоновые изображения и обложки для YouTube.

**Основная цель** — предоставить авторам, маркетологам и энтузиастам мощный инструмент для быстрого создания качественного контента, минимизируя ручной труд и предоставляя гибкие инструменты для итеративного улучшения результата.

### Ключевые возможности:

#### **Генерация контента с помощью ИИ**
*   **Продвинутый AI-копирайтинг:** Генерирует несколько SEO-оптимизированных вариантов заголовка, подробное описание и релевантные теги для YouTube.
*   **Создание персонажей и сценариев:** Разрабатывает уникальных персонажей для диалогов и пишет полные, многоглавные сценарии.
*   **Гибкий источник знаний:** Использует Google Search для сбора актуальной информации или работает на основе предоставленного пользователем текста («База знаний»). Базу знаний можно интерактивно пополнять новыми данными из поиска Google прямо в интерфейсе.
*   **Настраиваемый стиль:** Предлагает два режима: «Творческая свобода» (в стиле Кинга/Лавкрафта) или «Документальная точность».
*   **Глобальный охват:** Поддерживает генерацию контента на более чем 40 языках с удобным поиском в выпадающем списке.

#### **Продвинутое аудио-производство**
*   **Профессиональная озвучка:** Использует высококачественные модели Google TTS. Поддерживает как режим монолога, так и диалога с несколькими спикерами и возможностью выбора голоса для каждого персонажа. Функция предпрослушивания голосов с кэшированием в IndexedDB обеспечивает мгновенное воспроизведение.
*   **Гибкий подбор музыки:**
    *   **AI-помощник:** Искусственный интеллект анализирует настроение главы и предлагает ключевые слова и список подходящих треков из библиотеки Jamendo.
    *   **Ручной поиск:** Предоставляет полный контроль, позволяя искать музыку по собственным ключевым словам.
    *   **Интерактивное превью:** Позволяет прослушивать найденные треки и **в реальном времени регулировать громкость**, чтобы сразу оценить, как музыка будет звучать в миксе.
    *   **Неразрушающее редактирование:** При поиске новых вариантов текущий трек сохраняется, а выбор нового подтверждается кнопками "Сохранить" / "Отмена".
*   **Динамическое сведение:** Автоматически микширует речь и фоновую музыку. Позволяет настраивать общую громкость музыки для всего проекта, а также **индивидуальную громкость для каждой главы**. Система создает плавные переходы (crossfades) между разными треками в соседних главах.
*   **Форматы экспорта:** Готовый подкаст можно скачать в виде высококачественного `.WAV` файла или сжатого `.MP3`.

#### **Визуальный дизайн и графика**
*   **AI-генерация изображений:** Создает галерею атмосферных фоновых изображений на основе промптов, сгенерированных ИИ.
*   **AI-дизайнер обложек:** Разрабатывает несколько концепций для YouTube-обложек в стиле топ-блогеров, уделяя особое внимание высокой контрастности и читаемости текста.
*   **Интерактивный редактор:** Позволяет тонко настраивать текст, выбирать шрифты (с автодополнением из Google Fonts), цвета, тени и положение текста на любом из сгенерированных фонов.

#### **Полный контроль и отказоустойчивость**
*   **Гранулярная регенерация:** Позволяет независимо пересоздать любую часть проекта: текстовые материалы, все изображения, одно конкретное изображение, всю озвучку или одну главу, не начиная все с нуля.
*   **Конвейерная генерация:** Процесс создания глав организован в очередь, которую можно приостановить и возобновить в любой момент.
*   **Резервные AI-модели (Fallback):** Система автоматически переключается на резервные модели для генерации текста (`gemini-2.5-flash` -> `gemini-flash-lite-latest`) и изображений (Gemini -> OpenRouter) для обеспечения максимальной надежности.
*   **История и кэширование:** Сохраняет историю проектов в `localStorage` и кэширует предпрослушивание голосов в `IndexedDB` для экономии времени и API-запросов.

#### **Инструменты и экспорт**
*   **Управление API-ключами:** Удобный интерфейс для ввода и сохранения персональных API-ключей для Google Gemini и OpenRouter.
*   **Журнал событий:** Встроенная консоль отображает все API-запросы, ответы и ошибки в режиме реального времени.
*   **Тестовые панели:** Включает отдельные инструменты для изолированного тестирования AI-дизайнера обложек и системы подбора музыки.
*   **Генерация SRT-субтитров:** Мгновенно создает файл субтитров в формате `.srt`. **Примечание:** таймкоды рассчитываются на основе анализа длины текста для скорости и могут потребовать небольшой ручной корректировки для идеальной синхронизации.


## 2. Используемые технологии

*   **Фронтенд:** React 19, TypeScript, Tailwind CSS.
*   **Искусственный интеллект:** Google Gemini API (`gemini-2.5-flash`, `gemini-flash-lite-latest`, `gemini-2.5-flash-image`, `gemini-2.5-flash-preview-tts`), OpenRouter API (Fallback).
*   **Сторонние сервисы:** Jamendo API (для музыки).
*   **Браузерные API:** Web Audio API, Canvas API, IndexedDB, LocalStorage API.

## 3. Настройка и запуск

Приложение является полностью клиентским и не требует серверной части.

1.  **API-ключи:**
    *   **Google Gemini & OpenRouter:** Нажмите на иконку ключа в интерфейсе, чтобы ввести и сохранить ваши API-ключи. Они будут сохранены локально в вашем браузере.
    *   Если ключ Gemini не введен, приложение попытается использовать ключ из переменной окружения `process.env.API_KEY`.
2.  **Запуск:** Просто откройте файл `index.html` в современном веб-браузере.

## 4. Примечания для разработчиков

### Архитектура и структура проекта (после рефакторинга)

Приложение было рефакторено для повышения читаемости, масштабируемости и управляемости кода. Вместо одного монолитного компонента `App.tsx` теперь используется четкая компонентная архитектура с централизованным управлением состоянием.

*   **`App.tsx` (Компонент-оркестратор):**
    *   Выступает в роли точки входа.
    *   Управляет отображением глобальных элементов (модальные окна, панель логов).
    *   Рендерит один из трех основных компонентов в зависимости от состояния приложения: `ProjectSetup`, `PodcastStudio` или `LoadingScreen`.

*   **Основные компоненты (`/components`):**
    *   **`ProjectSetup.tsx`:** Отвечает за весь интерфейс создания нового проекта (форма ввода, настройки, история).
    *   **`PodcastStudio.tsx`:** Отвечает за основной рабочий интерфейс для уже сгенерированного подкаста (список глав, галерея, инструменты регенерации).
    *   **`LoadingScreen.tsx`:** Отображает экран загрузки с детализацией шагов во время генерации.

*   **Управление состоянием (`/hooks` и `/context`):**
    *   **`PodcastContext.tsx`:** Глобальный контекст, который предоставляет всем дочерним компонентам доступ к состоянию подкаста и функциям для работы с ним, устраняя необходимость "прокидывать" пропсы через множество уровней.
    *   **`usePodcast.ts`:** Кастомный хук, инкапсулирующий всю бизнес-логику: API-запросы для генерации, управление состоянием загрузки, обработку ошибок и все функции регенерации.
    *   **`useHistory.ts`:** Кастомный хук, отвечающий за управление историей проектов в `localStorage`.

*   **Изолированные сервисы (`/services`):**
    *   Логика взаимодействия с внешними API (Gemini, Jamendo) и браузерными API (Canvas, IndexedDB) вынесена в отдельные, независимые модули. Это делает код чище и упрощает его тестирование и повторное использование.

### Jamendo API Client ID
*   Ключ для Jamendo жестко закодирован в коде. Чтобы его изменить, откройте файл `services/ttsService.ts` и отредактируйте значение константы `JAMENDO_CLIENT_ID`.

## 5. План развития (Roadmap)

*   **Этап 1: Улучшение контроля и форматов (Завершено)**
    *   [x] Генерация SRT субтитров с таймкодами.
    *   [x] Конвертация в MP3.
    *   [x] Автоматический подбор и поглавное микширование фоновой музыки с переходами.
*   **Этап 2: Переход к видео и звуку**
    *   [ ] **Продвинутое микширование (Audio Ducking):** Автоматическое приглушение фоновой музыки во время речи диктора.
    *   [ ] **Анимация фоновых изображений:** Добавление легкого эффекта движения (Ken Burns) к фонам.
    *   [ ] **Создание видео-слайдшоу:** Автоматическая сборка видео из сгенерированных изображений.
    *   [ ] **Автоматический подбор SFX:** Поиск и интеграция звуковых эффектов.
*   **Этап 3: Расширенная кастомизация и AI-улучшения**
    *   [ ] **AI-агент для улучшения обложек:** ИИ будет анализировать сгенерированные обложки и автоматически корректировать расположение и стиль текста для максимальной читаемости.
    *   [ ] **Пользовательские системные промпты:** Возможность изменять базовые инструкции для ИИ.
    *   [ ] **Интеграция YouTube-призывов:** ИИ будет органично вставлять в сценарий призывы поставить лайк и подписаться.
*   **Этап 4: Новые форматы и автоматизация**
    *   [ ] **Генерация Reels/Shorts:** Отдельный рабочий процесс для создания коротких вертикальных видео с синхронизацией под биты музыки.
    *   [ ] **Интеграция с Google Drive:** Автоматическая выгрузка всех материалов проекта.